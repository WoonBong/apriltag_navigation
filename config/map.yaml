# AprilTag Navigation Map Configuration
# All map topology, tag coordinates, and task definitions

# Tag Database
tags:
  # Dock
  508:
    x: -0.3975
    y: 5.35
    type: DOCK
    zone: DOCK

  # Pivot Tags
  500:
    x: 0.0525
    y: 5.35
    type: PIVOT
    zone: A
    name: Entry_LB
  501:
    x: -0.3975
    y: 5.80
    type: PIVOT
    zone: B
    name: Exit_LB
  502:
    x: 3.2525
    y: 5.35
    type: PIVOT
    zone: A
    name: Entry_MB
  503:
    x: 2.8025
    y: 4.90
    type: PIVOT
    zone: C
    name: Exit_MB
  504:
    x: 3.9225
    y: 5.35
    type: PIVOT
    zone: A
    name: Entry_MB_R
  505:
    x: 3.4725
    y: 5.80
    type: PIVOT
    zone: D
    name: Exit_MB_R
  506:
    x: 7.1225
    y: 5.35
    type: PIVOT
    zone: A
    name: Entry_RB
  507:
    x: 6.6725
    y: 4.90
    type: PIVOT
    zone: E
    name: Exit_RB

  # Zone A Moving Tags (Left)
  400:
    x: 0.4525
    y: 5.35
    type: MOVE
    zone: A
  401:
    x: 0.8525
    y: 5.35
    type: MOVE
    zone: A
  402:
    x: 1.2525
    y: 5.35
    type: MOVE
    zone: A
  403:
    x: 1.6525
    y: 5.35
    type: MOVE
    zone: A
  404:
    x: 2.0525
    y: 5.35
    type: MOVE
    zone: A
  405:
    x: 2.4525
    y: 5.35
    type: MOVE
    zone: A
  406:
    x: 2.8525
    y: 5.35
    type: MOVE
    zone: A

  # Zone A Moving Tags (Right)
  408:
    x: 4.3225
    y: 5.35
    type: MOVE
    zone: A
  409:
    x: 4.7225
    y: 5.35
    type: MOVE
    zone: A
  410:
    x: 5.1225
    y: 5.35
    type: MOVE
    zone: A
  411:
    x: 5.5225
    y: 5.35
    type: MOVE
    zone: A
  412:
    x: 5.9225
    y: 5.35
    type: MOVE
    zone: A
  413:
    x: 6.3225
    y: 5.35
    type: MOVE
    zone: A
  414:
    x: 6.7225
    y: 5.35
    type: MOVE
    zone: A

  # Transition Moving Tags
  407:
    x: 2.8025
    y: 4.395
    type: MOVE
    zone: C
  415:
    x: 6.6725
    y: 4.395
    type: MOVE
    zone: E

  # Zone B Work Tags (111 -> 100)
  111:
    x: -0.3975
    y: 4.85
    type: WORK
    zone: B
  110:
    x: -0.3975
    y: 4.45
    type: WORK
    zone: B
  109:
    x: -0.3975
    y: 4.05
    type: WORK
    zone: B
  108:
    x: -0.3975
    y: 3.65
    type: WORK
    zone: B
  107:
    x: -0.3975
    y: 3.25
    type: WORK
    zone: B
  106:
    x: -0.3975
    y: 2.85
    type: WORK
    zone: B
  105:
    x: -0.3975
    y: 2.45
    type: WORK
    zone: B
  104:
    x: -0.3975
    y: 2.05
    type: WORK
    zone: B
  103:
    x: -0.3975
    y: 1.65
    type: WORK
    zone: B
  102:
    x: -0.3975
    y: 1.25
    type: WORK
    zone: B
  101:
    x: -0.3975
    y: 0.85
    type: WORK
    zone: B
  100:
    x: -0.3975
    y: 0.45
    type: WORK
    zone: B

  # Zone C Work Tags (112 -> 123)
  112:
    x: 2.8025
    y: 3.995
    type: WORK
    zone: C
  113:
    x: 2.8025
    y: 3.595
    type: WORK
    zone: C
  114:
    x: 2.8025
    y: 3.195
    type: WORK
    zone: C
  115:
    x: 2.8025
    y: 2.795
    type: WORK
    zone: C
  116:
    x: 2.8025
    y: 2.395
    type: WORK
    zone: C
  117:
    x: 2.8025
    y: 1.995
    type: WORK
    zone: C
  118:
    x: 2.8025
    y: 1.595
    type: WORK
    zone: C
  119:
    x: 2.8025
    y: 1.195
    type: WORK
    zone: C
  120:
    x: 2.8025
    y: 0.795
    type: WORK
    zone: C
  121:
    x: 2.8025
    y: 0.395
    type: WORK
    zone: C
  122:
    x: 2.8025
    y: -0.005
    type: WORK
    zone: C
  123:
    x: 2.8025
    y: -0.405
    type: WORK
    zone: C

  # Zone D Work Tags (135 -> 124)
  135:
    x: 3.4725
    y: 4.85
    type: WORK
    zone: D
  134:
    x: 3.4725
    y: 4.45
    type: WORK
    zone: D
  133:
    x: 3.4725
    y: 4.05
    type: WORK
    zone: D
  132:
    x: 3.4725
    y: 3.65
    type: WORK
    zone: D
  131:
    x: 3.4725
    y: 3.25
    type: WORK
    zone: D
  130:
    x: 3.4725
    y: 2.85
    type: WORK
    zone: D
  129:
    x: 3.4725
    y: 2.45
    type: WORK
    zone: D
  128:
    x: 3.4725
    y: 2.05
    type: WORK
    zone: D
  127:
    x: 3.4725
    y: 1.65
    type: WORK
    zone: D
  126:
    x: 3.4725
    y: 1.25
    type: WORK
    zone: D
  125:
    x: 3.4725
    y: 0.85
    type: WORK
    zone: D
  124:
    x: 3.4725
    y: 0.45
    type: WORK
    zone: D

  # Zone E Work Tags (136 -> 147)
  136:
    x: 6.6725
    y: 3.995
    type: WORK
    zone: E
  137:
    x: 6.6725
    y: 3.595
    type: WORK
    zone: E
  138:
    x: 6.6725
    y: 3.195
    type: WORK
    zone: E
  139:
    x: 6.6725
    y: 2.795
    type: WORK
    zone: E
  140:
    x: 6.6725
    y: 2.395
    type: WORK
    zone: E
  141:
    x: 6.6725
    y: 1.995
    type: WORK
    zone: E
  142:
    x: 6.6725
    y: 1.595
    type: WORK
    zone: E
  143:
    x: 6.6725
    y: 1.195
    type: WORK
    zone: E
  144:
    x: 6.6725
    y: 0.795
    type: WORK
    zone: E
  145:
    x: 6.6725
    y: 0.395
    type: WORK
    zone: E
  146:
    x: 6.6725
    y: -0.005
    type: WORK
    zone: E
  147:
    x: 6.6725
    y: -0.405
    type: WORK
    zone: E

# Navigation Graph Edges
edges:
  # Zone A corridor (bidirectional forward/backward)
  - from: 508
    to: 500
    direction: forward
    type: move
  - from: 500
    to: 508
    direction: backward
    type: move

  - from: 500
    to: 400
    direction: forward
    type: move
  - from: 400
    to: 500
    direction: backward
    type: move

  - from: 400
    to: 401
    direction: forward
    type: move
  - from: 401
    to: 400
    direction: backward
    type: move

  - from: 401
    to: 402
    direction: forward
    type: move
  - from: 402
    to: 401
    direction: backward
    type: move

  - from: 402
    to: 403
    direction: forward
    type: move
  - from: 403
    to: 402
    direction: backward
    type: move

  - from: 403
    to: 404
    direction: forward
    type: move
  - from: 404
    to: 403
    direction: backward
    type: move

  - from: 404
    to: 405
    direction: forward
    type: move
  - from: 405
    to: 404
    direction: backward
    type: move

  - from: 405
    to: 406
    direction: forward
    type: move
  - from: 406
    to: 405
    direction: backward
    type: move

  - from: 406
    to: 502
    direction: forward
    type: move
  - from: 502
    to: 406
    direction: backward
    type: move

  - from: 502
    to: 504
    direction: forward
    type: move
  - from: 504
    to: 502
    direction: backward
    type: move

  - from: 504
    to: 408
    direction: forward
    type: move
  - from: 408
    to: 504
    direction: backward
    type: move

  - from: 408
    to: 409
    direction: forward
    type: move
  - from: 409
    to: 408
    direction: backward
    type: move

  - from: 409
    to: 410
    direction: forward
    type: move
  - from: 410
    to: 409
    direction: backward
    type: move

  - from: 410
    to: 411
    direction: forward
    type: move
  - from: 411
    to: 410
    direction: backward
    type: move

  - from: 411
    to: 412
    direction: forward
    type: move
  - from: 412
    to: 411
    direction: backward
    type: move

  - from: 412
    to: 413
    direction: forward
    type: move
  - from: 413
    to: 412
    direction: backward
    type: move

  - from: 413
    to: 414
    direction: forward
    type: move
  - from: 414
    to: 413
    direction: backward
    type: move

  - from: 414
    to: 506
    direction: forward
    type: move
  - from: 506
    to: 414
    direction: backward
    type: move

  # Zone B (after pivot at 500->501)
  - from: 500
    to: 501
    direction: turn_ccw_90
    type: pivot
  - from: 501
    to: 500
    direction: turn_cw_90
    type: pivot

  - from: 501
    to: 111
    direction: backward
    type: move
  - from: 111
    to: 501
    direction: forward
    type: move

  - from: 111
    to: 110
    direction: backward
    type: move
  - from: 110
    to: 111
    direction: forward
    type: move

  - from: 110
    to: 109
    direction: backward
    type: move
  - from: 109
    to: 110
    direction: forward
    type: move

  - from: 109
    to: 108
    direction: backward
    type: move
  - from: 108
    to: 109
    direction: forward
    type: move

  - from: 108
    to: 107
    direction: backward
    type: move
  - from: 107
    to: 108
    direction: forward
    type: move

  - from: 107
    to: 106
    direction: backward
    type: move
  - from: 106
    to: 107
    direction: forward
    type: move

  - from: 106
    to: 105
    direction: backward
    type: move
  - from: 105
    to: 106
    direction: forward
    type: move

  - from: 105
    to: 104
    direction: backward
    type: move
  - from: 104
    to: 105
    direction: forward
    type: move

  - from: 104
    to: 103
    direction: backward
    type: move
  - from: 103
    to: 104
    direction: forward
    type: move

  - from: 103
    to: 102
    direction: backward
    type: move
  - from: 102
    to: 103
    direction: forward
    type: move

  - from: 102
    to: 101
    direction: backward
    type: move
  - from: 101
    to: 102
    direction: forward
    type: move

  - from: 101
    to: 100
    direction: backward
    type: move
  - from: 100
    to: 101
    direction: forward
    type: move

  # Zone C (after pivot at 502->503)
  - from: 502
    to: 503
    direction: turn_cw_90
    type: pivot
  - from: 503
    to: 502
    direction: turn_ccw_90
    type: pivot

  - from: 503
    to: 407
    direction: forward
    type: move
  - from: 407
    to: 503
    direction: backward
    type: move

  - from: 407
    to: 112
    direction: forward
    type: move
  - from: 112
    to: 407
    direction: backward
    type: move

  - from: 112
    to: 113
    direction: forward
    type: move
  - from: 113
    to: 112
    direction: backward
    type: move

  - from: 113
    to: 114
    direction: forward
    type: move
  - from: 114
    to: 113
    direction: backward
    type: move

  - from: 114
    to: 115
    direction: forward
    type: move
  - from: 115
    to: 114
    direction: backward
    type: move

  - from: 115
    to: 116
    direction: forward
    type: move
  - from: 116
    to: 115
    direction: backward
    type: move

  - from: 116
    to: 117
    direction: forward
    type: move
  - from: 117
    to: 116
    direction: backward
    type: move

  - from: 117
    to: 118
    direction: forward
    type: move
  - from: 118
    to: 117
    direction: backward
    type: move

  - from: 118
    to: 119
    direction: forward
    type: move
  - from: 119
    to: 118
    direction: backward
    type: move

  - from: 119
    to: 120
    direction: forward
    type: move
  - from: 120
    to: 119
    direction: backward
    type: move

  - from: 120
    to: 121
    direction: forward
    type: move
  - from: 121
    to: 120
    direction: backward
    type: move

  - from: 121
    to: 122
    direction: forward
    type: move
  - from: 122
    to: 121
    direction: backward
    type: move

  - from: 122
    to: 123
    direction: forward
    type: move
  - from: 123
    to: 122
    direction: backward
    type: move

  # Zone D (after pivot at 504->505)
  - from: 504
    to: 505
    direction: turn_ccw_90
    type: pivot
  - from: 505
    to: 504
    direction: turn_cw_90
    type: pivot

  - from: 505
    to: 135
    direction: backward
    type: move
  - from: 135
    to: 505
    direction: forward
    type: move

  - from: 135
    to: 134
    direction: backward
    type: move
  - from: 134
    to: 135
    direction: forward
    type: move

  - from: 134
    to: 133
    direction: backward
    type: move
  - from: 133
    to: 134
    direction: forward
    type: move

  - from: 133
    to: 132
    direction: backward
    type: move
  - from: 132
    to: 133
    direction: forward
    type: move

  - from: 132
    to: 131
    direction: backward
    type: move
  - from: 131
    to: 132
    direction: forward
    type: move

  - from: 131
    to: 130
    direction: backward
    type: move
  - from: 130
    to: 131
    direction: forward
    type: move

  - from: 130
    to: 129
    direction: backward
    type: move
  - from: 129
    to: 130
    direction: forward
    type: move

  - from: 129
    to: 128
    direction: backward
    type: move
  - from: 128
    to: 129
    direction: forward
    type: move

  - from: 128
    to: 127
    direction: backward
    type: move
  - from: 127
    to: 128
    direction: forward
    type: move

  - from: 127
    to: 126
    direction: backward
    type: move
  - from: 126
    to: 127
    direction: forward
    type: move

  - from: 126
    to: 125
    direction: backward
    type: move
  - from: 125
    to: 126
    direction: forward
    type: move

  - from: 125
    to: 124
    direction: backward
    type: move
  - from: 124
    to: 125
    direction: forward
    type: move

  # Zone E (after pivot at 506->507)
  - from: 506
    to: 507
    direction: turn_cw_90
    type: pivot
  - from: 507
    to: 506
    direction: turn_ccw_90
    type: pivot

  - from: 507
    to: 415
    direction: forward
    type: move
  - from: 415
    to: 507
    direction: backward
    type: move

  - from: 415
    to: 136
    direction: forward
    type: move
  - from: 136
    to: 415
    direction: backward
    type: move

  - from: 136
    to: 137
    direction: forward
    type: move
  - from: 137
    to: 136
    direction: backward
    type: move

  - from: 137
    to: 138
    direction: forward
    type: move
  - from: 138
    to: 137
    direction: backward
    type: move

  - from: 138
    to: 139
    direction: forward
    type: move
  - from: 139
    to: 138
    direction: backward
    type: move

  - from: 139
    to: 140
    direction: forward
    type: move
  - from: 140
    to: 139
    direction: backward
    type: move

  - from: 140
    to: 141
    direction: forward
    type: move
  - from: 141
    to: 140
    direction: backward
    type: move

  - from: 141
    to: 142
    direction: forward
    type: move
  - from: 142
    to: 141
    direction: backward
    type: move

  - from: 142
    to: 143
    direction: forward
    type: move
  - from: 143
    to: 142
    direction: backward
    type: move

  - from: 143
    to: 144
    direction: forward
    type: move
  - from: 144
    to: 143
    direction: backward
    type: move

  - from: 144
    to: 145
    direction: forward
    type: move
  - from: 145
    to: 144
    direction: backward
    type: move

  - from: 145
    to: 146
    direction: forward
    type: move
  - from: 146
    to: 145
    direction: backward
    type: move

  - from: 146
    to: 147
    direction: forward
    type: move
  - from: 147
    to: 146
    direction: backward
    type: move

# Task Definitions
tasks:
  task1:
    description: "Zone B + C coverage"
    waypoints: [508, 500, 501, 111, 110, 109, 108, 107, 106, 105, 104, 103, 102, 101, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 501, 500, 400, 401, 402, 403, 404, 405, 406, 502, 503, 407, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 122, 121, 120, 119, 118, 117, 116, 115, 114, 113, 112, 407, 503, 502, 406, 405, 404, 403, 402, 401, 400, 500, 508]

  task2:
    description: "Zone D + E coverage"
    waypoints: [508, 500, 400, 401, 402, 403, 404, 405, 406, 502, 504, 505, 135, 134, 133, 132, 131, 130, 129, 128, 127, 126, 125, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 505, 504, 408, 409, 410, 411, 412, 413, 414, 506, 507, 415, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 146, 145, 144, 143, 142, 141, 140, 139, 138, 137, 136, 415, 507, 506, 414, 413, 412, 411, 410, 409, 408, 504, 502, 406, 405, 404, 403, 402, 401, 400, 500, 508]

# Robot Parameters
robot:
  length: 0.80  # meters
  width: 0.50  # meters
  camera_offset: 0.45  # meters from robot center to front

  speeds:
    linear: 0.3  # m/s
    angular: 0.25  # rad/s
    slow_factor: 0.3  # for dock approach

  thresholds:
    align_angle: 0.5  # degrees
    lateral: 0.05  # meters
    center_y_tolerance: 50  # pixels

  wall_distances:
    work_zone: 0.35  # meters (Zone B/C/D/E)
    zone_a: 0.6275  # meters
    min_clearance: 0.10  # meters

  pure_pursuit:
    look_ahead_base: 0.4  # meters (tag spacing)
    gain_forward: 1.0
    gain_backward: 0.8
    deadband_cte: 0.005  # meters (5mm)
    deadband_heading: 1.0  # degrees

  tag_size: 0.06  # meters (6cm)

  camera:
    width: 1280
    height: 720
